
      <!-- title -->
      <section>
        <!-- landing -->
        <section id="home">
          <h1>Cloud Native OCI</h1>
          <h2>ATP + OCI Service Broker</h2>
          include "partials/_titleSlide.html"
        </section>

        <!-- TOC -->
        <section id="toc">
          <h2>Table of Contents</h2>
          <ul>
            <!-- add a line for each <section id="slideId">...</section>  -->
            <li><a href="#home">Home</a></li>
            <li><a href="#Overview">Overview</a></li>
            <li><a href="#lab">Demo/Lab</a></li>
            <li><a href="#resources">Resources</a></li>
          </ul>
        </section>
        
      </section>

      <!-- Overview -->
      <section id="Overview">
        <h2>Architecture Overview</h2>
        <img class="plain no-margin" data-src="https://cdn.app.compendium.com/uploads/user/e7c690e8-6ff9-102a-ac6d-e4aebca50425/41d1c169-5ecc-4442-ab54-fc8d9cb3cdc6/Image/9a2cd983e25311180b4bf604fd7d58d9/svc_brkr_arch_4.jpg" alt="OCI Service Broker Architecture" />
      </section>

      <!-- Lab Requirements -->
      <!-- <section id="labReq">
          <section id="labReq-great">
            <h2>Lab Requirements</h2>
            <div class="fragment fade-out">
                <p>Helm and svcat cli installed? </p>
                <p><green>Yes?</green> great, go left.     <red>No?</red> go down.</p>
            </div>
          </section>
          <section id="labReq-now">
              <h2>Lab Requirements</h2>
              <div class="fragment fade-in">
                  <p class="mu-small">Make sure helm client installed. If not, install using this command. Will also install the optional svcat cli (MacOS)</p>
                  <pre><code class="hljs text">brew update && brew install kubernetes-helm kubernetes-service-catalog-client</code></pre>
                  <p class="mu-small">Check if you have helm installed on the server</p>
                  <pre><code class="hljs text">helm version</code></pre>
                  <p class="mu-small">The Helm version command should give result similar to this:</p>
                  <pre><code class="hljs text">> helm version
            Client: &version.Version{SemVer:"v2.14.3", GitCommit:"5270352a09c7e8b6e8c9593002a73535276507c0", GitTreeState:"clean"}
            Server: &version.Version{SemVer:"v2.14.3", GitCommit:"5270352a09c7e8b6e8c9593002a73535276507c0", GitTreeState:"clean"}</code></pre>
                  <p class="mu-small">If you receive an error tha could not find tiller pod on the server, you need to install to you your cluster</p>
                  <pre><code class="hljs text">helm init --history-max 200</code></pre>
              </div>
          </section>
      </section> -->
      
<!-- Lab/Overview -->
<section id="overview">
  <h2>Lab Overview</h2>
  <ul>
    <li>Installing Service Catalog</li>
    <li>Deploying OCI Service Broker</li>
    <li>Provisioning ATP</li>
    <li>Binding to created ATP (wallet auto-creation)</li>
    <li>Deploying catalogue app</li>
  </ul>
</section>

<section id="setup">
  <h2>Setup Service Broker</h2>
  <div class="mu-flex mu-small switcher">
    <ul>
      <li class="fragment">Install Service Catalog</li>
      <li class="fragment">Add OCI Service Broker</li>
      <li class="fragment">Register Cluster Broker</li>
      <li class="fragment">Verify</li>
    </ul>
    <ul class="col-1-1">
      <!-- install svc cat -->
      <li>
        <blockquote class="mu-medium no-margin">
          üëç Good news! You already installed <code>svc-cat/catalog</code> as part of the
          umbrella chart during <a href="/workshop/setup.html#setup"><code>setup</code></a>. 
          In case this <em>was not</em> completed, here are steps to do so:
        </blockquote>
        <hr>
        <div class="mu-margin-top">
          Add the Kubernetes Service Catalog helm repository:
          <pre class="mu-margin"><code class="hljs text">helm repo add svc-cat https://svc-catalog-charts.storage.googleapis.com</code></pre>
          Install the Kubernetes Service Catalog helm chart:
          <pre><code class="hljs text">helm install svc-cat/catalog \
  --name catalog \
  --namespace service-catalog </code></pre>
          <blockquote class="mu-small">
            <div class="mu-margin">
              ‚ÑπÔ∏è Please note that the above command configures the Service Catalog using an embedded etcd instance.
              It is not recommended to run the Service Catalog using an embedded etcd instance in production environments,
              instead a separate etcd cluster should be setup and used by the Service Catalog.
            </div>
            The open source etcd operator project or a commercial offering may be used to setup a production quality etcd cluster.
          </blockquote>
        </div>
      </li>
      <!-- oci service broker -->
      <li>
        <div class="mu-small">
          The OCI Service Broker for Kubernetes uses access credentials to provision and
          manage services and resources in the user tenancy.
          <pre><code class="hljs shell">kubectl create secret generic oci-service-broker \
  --namespace mushop \
  --from-literal=tenancy=&lt;TENANCY_OCID&gt; \
  --from-literal=user=&lt;USER_OCID&gt; \
  --from-literal=region=&lt;USER_OCI_REGION&gt; \
  --from-literal=fingerprint=&lt;PUBLIC_API_KEY_FINGERPRINT&gt; \
  --from-literal=passphrase=&lt;PRIVATE_API_KEY_PASSPHRASE&gt; \
  --from-file=privatekey=&lt;PATH_OF_PRIVATE_API_KEY&gt;</code></pre>

          <blockquote class="mu-">
            ‚ö†Ô∏è <b>NOTE:</b> The account used must have sufficient policies in <b>IAM</b> to manage 
            resources provisioned with Service Broker
          </blockquote>

          Next, deploy the OCI service broker on your cluster. Note the
          <b><code>secretName=oci-service-broker</code></b> created above.
          <pre><code class="hljs text">helm install https://github.com/oracle/oci-service-broker/releases/download/v1.3.1/oci-service-broker-1.3.1.tgz \
  --namespace mushop \
  --name oci-service-broker \
  --set ociCredentials.secretName=oci-service-broker \
  --set storage.etcd.useEmbedded=true \
  --set tls.enabled=false</code></pre>

          <blockquote class="mu-">
            <div class="mu-margin">
              ‚ÑπÔ∏è Please note that the above command will deploy the OCI Service Broker using an embedded etcd instance.
              It is not recommended to deploy the OCI Service Broker using an embedded etcd instance and tls disabled in
              production environments, instead a separate etcd cluster should be setup and used by the OSB.
            </div>
            The open source etcd operator project or a commercial offering may be used to setup a production quality etcd
            cluster. The recommended setup can be found <a
              href="https://github.com/oracle/oci-service-broker/blob/master/charts/oci-service-broker/docs/installation.md#recommended-setup"
              target="_blank">here</a>
          </blockquote>
        </div>
      </li>
      <!-- clusterbroker -->
      <li>
        <div class="mu-margin">Register OCI Service Broker</div>
        <div class="mu-margin mu-flex mu-flex-middle">
          <div class="mu-svc"><img data-src="/images/tech/k8s.png"></div>
          <div class="mu-center mu-flex-connector arrow arrow-left">Service Broker</div>
          <div class="mu-svc"><img data-src="/images/tech/osbroker.png"></div>
          <div class="mu-center mu-flex-connector arrow arrow-left">Service Catalog</div>
          <div class="mu-svc"><img data-src="/images/tech/oci.png"></div>
        </div>
        <hr>
        <div class="mu-medium">
          <p>Create a file <a href="/public/oci-service-broker.yaml"><b><code>oci-service-broker.yaml</code></b></a>
          with the following contents:</p>
          <pre><code class="hljs yaml">apiVersion: servicecatalog.k8s.io/v1beta1
kind: ClusterServiceBroker
metadata:
  name: oci-service-broker
spec:
  url: http://oci-service-broker.mushop:8080</code></pre>
  
          <pre><code class="hljs text">kubectl create -f oci-service-broker.yaml</code></pre>
        </div>
      </li>
      <!-- verify -->
      <li>
        Verify that the Service Broker is available and ready:
        <pre><code class="hljs text">kubectl get clusterservicebrokers -o 'custom-columns=BROKER:.metadata.name,STATUS:.status.conditions[0].reason'</code></pre>
        <pre><code class="hljs text">BROKER              STATUS
oci-service-broker  FetchedCatalog</code></pre>
        Using the <code>svcat</code> CLI to see the status, service and plans available:
        <pre><code class="hljs text">svcat get brokers</code></pre>
        <pre><code class="hljs text">svcat get classes</code></pre>
        <pre><code class="hljs text">svcat get plans</code></pre>
        <pre><code class="hljs text">    NAME     NAMESPACE          CLASS                       DESCRIPTION            
+----------+-----------+----------------------+-------------------------------------+
  standard               atp-service            OCI Autonomous Transaction Processing                      
  archive                object-store-service   An Archive type Object Storage  
  standard               object-store-service   A Standard type Object Storage  
  standard               adw-service            OCI Autonomous Data Warehouse   
  standard               oss-service            Oracle Streaming Service</code></pre>
      </li>
    </ul>
  </div>
</section>

<section id="lab">
  <h2>Hands-on Service Broker</h2>
  <div class="mu-small mu-left">
    Follow the steps outlined here to provision an ATP <em>instance</em> and resolve
    a <em>binding</em> secret with its DB Connection Wallet:
  </div>
  <hr>
  <div class="mu-flex mu-small switcher">
    <ul>
      <li class="fragment">üîêNotice</li>
      <li class="fragment">Provision ATP</li>
      <li class="fragment">Service Binding</li>
      <li class="fragment">Run MuShop</li>
      <li class="fragment">Under the Hood</li>
      <li class="fragment">Full Automation</li>
    </ul>
    <ul class="col-1-1 mu-medium">
      <!-- notice -->
      <li>
        <p class="no-margin">
          ‚ö†Ô∏è <b>NOTE:</b> The sample files in this exercise are using
          <b>plain password</b> instead of secrets for the sake of simplicity.
        </p>
        <p>
          For detailed instructions using proper secrets, please refer to the mushop
          source repo, under <code>src/catalogue/kubernetes/</code> folder.
        </p>
      </li>
      <!-- instance -->
      <li>
        Resources provisioned (or claimed) by Service Broker are called <b>Service Instances</b>.
        Create an ATP Service Instance as follows:
        <p>Create the file <a href="/public/catalogue-oadb-instance.yaml"><b><code>catalogue-oadb-instance.yaml</code></b></a>
        with the following contents:</p>
        <pre><code class="hljs yaml">apiVersion: servicecatalog.k8s.io/v1beta1
kind: ServiceInstance
metadata:
  name: catalogue-db-dev
spec:
  clusterServiceClassExternalName: atp-service
  clusterServicePlanExternalName: standard
  parameters:
    name: "MuShop Catalogue DB - dev"
    compartmentId: #[target compartment id. e.g.: ocid1.compartment.oc1..aaaaaaa...]
    dbName: cataloguedev
    cpuCount: 1
    storageSizeTBs: 1
    password: s123456789S@
    licenseType: BYOL
    autoScaling: false</code></pre>
        <pre><code class="hljs text">kubectl create -f catalogue-oadb-instance.yaml</code></pre>
        <pre><code class="hljs text">kubectl get serviceinstances</code></pre>
      </li>
      <!-- binding -->
      <li>
        When Service Instances finish <code>Provisioning</code>, secrets in the form of 
        a <code>ServiceBinding</code> will be created, and become available for application
        use.
        <p>Create a file <a href="/public/catalogue-oadb-binding.yaml"><b><code>catalogue-oadb-binding.yaml</code></b></a>
          with the following contents:</p>
        <pre><code class="hljs yaml">apiVersion: servicecatalog.k8s.io/v1beta1
kind: ServiceBinding
metadata:
  name: catalogue-oadb-wallet-binding
spec:
  instanceRef:
    name: catalogue-db-dev
  parameters:
    walletPassword: "Welcome_123"</code></pre>
        <pre><code class="hljs text">kubectl create -f catalogue-oadb-binding.yaml</code></pre>
        <pre><code class="hljs text">kubectl get servicebindings</code></pre>
        Once the binding shows <b><code>READY</code></b>, a secret will also be available.
        For ATP, this secret is in the form of a Base64 encoded DB Connection Wallet:
        <pre><code class="hljs text">kubectl get secret catalogue-oadb-wallet-binding -o yaml</code></pre>
      </li>

      <!-- attach app -->
      <li>
        A new ATP instance is now ready and available. The next step is to configure
        access secrets, and (re)deploy the application.

        <blockquote class="mu-medium">
          ‚ö†Ô∏è <b>NOTE:</b> it is assumed that a MuShop chart configuration:
          <a href="/public/myvalues.yaml"><code>myvalues.yaml</code></a> already exists.
          
        </blockquote>
        <div class="mu-margin-top">
          <ol>
            <li>
              Remove a previous deployment <span class="mu-muted">(if applicable)</span>:
              <pre><code class="hljs text">helm del --purge mushop</code></pre>
            </li>
            <li>
              Create <code>catalogue-oadb-admin</code> secret:
              <pre><code class="hljs text">kubectl create secret generic catalogue-oadb-admin \
  --from-literal=oadb_admin_pw='s123456789S@'</code></pre>
            </li>
            <li>
              Define <code>catalogue-oadb-connection</code> secret:
              <pre><code class="hljs text">kubectl create secret generic catalogue-oadb-connection \
  --from-literal=oadb_service=cataloguedev_tp \
  --from-literal=oadb_user=CATALOGUE_USER  \
  --from-literal=oadb_pw='default_Password1'</code></pre>
            </li>
            <li>
              From the source code, traverse into the helm chart deployment directory:
              <pre><code class="hljs text">cd deploy/helm-chart</code></pre>
            </li>
            <li>
              Deploy MuShop with a flag indicating that the catalogue service is using
              an OCI Service Broker binding: <b><code>--set catalogue.osb.atp=true</code></b>
              <pre><code class="hljs text">helm install mushop \
  --name mushop \
  --set catalogue.osb.atp=true \
  -f myvalues.yaml</code></pre>
            </li>
          </ol>
        </div>
      </li>

      <!-- inspect -->
      <li>
        Once again, the use of <code>helm</code> adds some mystery to the ultimate
        deployment of the catalogue service. Inspect the following for additional
        information.

        <hr>
        <div class="mu- mu-flex mu-flex-stretch">
          <div class="card col-1-2">
            Inspect the catalogue deployment:
            <pre><code class="hljs text">kubectl get deploy mushop-catalogue -o yaml</code></pre>
            And the catalogue init pod <span class="mu-muted">(will vary)</span>: 
            <pre><code class="hljs text">kubectl get logs mushop-catalogue-1.2-init-d475m</code></pre>
          </div>
          <div class="mu-flex-connector mu-valign"></div>
          <div class="card col-1-2">
          Example deployment of catalogue service:
          <pre class="mu-ratio mu-ratio-1-1"><code class="hljs yaml"># Source: mushop/charts/catalogue/templates/catalogue-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mushop-catalogue
spec:
  replicas: 1
  #...
  template:
    #...
    spec:
      terminationGracePeriodSeconds: 5
      initContainers:
        # OSB Wallet Binding decoder
        - name: decode-binding
          image: oraclelinux:7-slim
          command: ["/bin/sh","-c"]
          args: 
          - for i in `ls -1 /tmp/wallet | grep -v user_name`; do cat /tmp/wallet/$i | base64 --decode > /wallet/$i; done; ls -l /wallet/*;
          volumeMounts:
            - name: wallet-binding
              mountPath: /tmp/wallet
              readOnly: true
            - name: wallet
              mountPath: /wallet
              readOnly: false
      containers:
        - name: catalogue
          image: "phx.ocir.io/intvravipati/mushop/catalogue:1.2"
          imagePullPolicy: Always
          #...
          env:
            - name: ZIPKIN
              value: 
            - name: OADB_USER
              valueFrom:
                secretKeyRef:
                  name: catalogue-oadb-connection
                  key: oadb_user
            - name: OADB_PW
              valueFrom:
                secretKeyRef:
                  name: catalogue-oadb-connection
                  key: oadb_pw
            - name: OADB_SERVICE
              valueFrom:
                secretKeyRef:
                  name: catalogue-oadb-connection
                  key: oadb_service
          volumeMounts:
            - name: wallet
              mountPath: /usr/lib/oracle/19.3/client64/lib/network/admin/
              readOnly: true
          #...
      volumes:
        # Service Broker Wallet binding
        - name: wallet-binding
          secret:
            secretName: catalogue-oadb-wallet-binding
        - name: wallet
          emptyDir: {}
        # service init configMap
        - name: initdb
          configMap:
            name: mushop-catalogue-init
            items:
            - key: atp.init.sql
              path: service.sql</code></pre>
        </div>
        </div>
      </li>

      <!-- automation -->
      <li>
        <blockquote class="no-margin mu-left">
          üíØ These steps may be <b>automated</b> by another helm chart included in the source repo:
          <pre><code class="hljs text">deploy/helm-chart/provision</code></pre>
        </blockquote>
        <p>
          The <code>provision</code> helm chart manages the following:
        </p>
        <ul class="mu-medium">
          <li>Service Broker API Secret</li>
          <li>Global ATP Instance/Binding</li>
          <li>Optional service-specific instance(s) <code class="mu-muted">(--set {svc}.osb.atp.true)</code></li>
          <li>Auto-generated <code>*-oadb-admin</code> secrets</li>
          <li>Auto-generated <code>*-oadb-connection</code> secrets</li>
        </ul>
        <hr>
        <h3>TL;DR</h3>
        Create instance(s) and binding(s):
        <pre><code class="hljs text">helm install provision --name mushop-provision</code></pre>
        ‚è≤Ô∏è Wait for servicebindings to be <b><code>READY</code></b>. Then deploy MuShop...
        <pre><code class="hljs text">helm install mushop --name mushop --set global.osb.atp=true</code></pre>
      </li>
    </ul>
  </div>

  <aside class="notes">
    Extra commands using svcat cli:
      # instance
      svcat get instances
      svcat describe instance catalogue-db-dev
      # bindings
      svcat get bindings
      kubectl get secret catalogue-oadb-wallet-binding -o yaml

    About deployment:
      catalogue-oadb-admin and catalogue-oadb-connection would otherwise be created
      by deploying <code>provision</code> chart.
  </aside>
</section>


      <!-- Lab/InstallServiceCatalog -->
      <!-- <section id="InstallServiceCatalog" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>Installing Service Catalog</h2>

        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p class="mu-small">Add the Kubernetes Service Catalog helm repository</p>
              <pre><code class="hljs text">helm repo add svc-cat https://svc-catalog-charts.storage.googleapis.com</code></pre>
              <p class="mu-small">Install the Kubernetes Service Catalog helm chart</p>
              <pre><code class="hljs text">helm install svc-cat/catalog \
            --name catalog \
            --namespace service-catalog </code></pre>
              <blockquote class="mu-xsmall">
                Please note that the above command will run the Service Catalog using an embedded etcd instance.
                It is not recommended to run the Service Catalog using an embedded etcd instance in production environments,
                instead a separate etcd cluster should be setup and used by the Service Catalog.
                The open source etcd operator project or a commercial offering may be used to setup a production quality etcd cluster.
              </blockquote>
            </div>
          </div>
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p class="mu-small">It may take a few seconds after the helm install command succeeds for the Service Catalog to start up in your cluster. To check on the status, run:</p>
              <pre><code class="hljs text">kubectl get deployment --namespace service-catalog</code></pre>
              <pre><code class="hljs text">NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE
catalog-catalog-apiserver            1/1     1            1           32s
catalog-catalog-controller-manager   1/1     1            1           32s</code></pre>
            </div>
          </div>
        </div>
      </section> -->



<!-- Lab/DeployingOCIServiceBroker -->
<!-- include "partials/highlights/_deployosb.html" -->



      <!-- <section id="notePlainPassword" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>*** NOTE ***</h2>
        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p>The deployment files in the following slides are using plain password instead of secrets for the sake of simplicity.</p>
              <p>For detailed instructions using proper secrets, please refer to the repo, under /src/catalogue/kubernetes/ folder.</p>
            </div>
          </div>
        </div>
      </section> -->

      <!-- <section id="provisioningATP" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>Provisioning ATP</h2>
        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p>Creating new ATP instance</p>
              <p class="mu-small">Create the file <a href="/public/catalogue-oadb-instance-dev.yaml"><b><code>catalogue-oadb-instance-dev.yaml</code></b></a>
              with the following content:</p>
              <pre class="mu-xsmall"><code class="hljs yaml">apiVersion: servicecatalog.k8s.io/v1beta1
kind: ServiceInstance
metadata:
  name: catalogue-db-dev
spec:
  clusterServiceClassExternalName: atp-service
  clusterServicePlanExternalName: standard
  parameters:
    name: "MuShop Catalogue DB - dev"
    compartmentId: #[target compartment id. e.g.: ocid1.compartment.oc1..aaaaaaa...]
    dbName: cataloguedev
    cpuCount: 1
    storageSizeTBs: 1
    password: s123456789S@
    licenseType: BYOL
    autoScaling: false</code></pre>
              <pre><code class="hljs text">kubectl create -f catalogue-oadb-instance-dev.yaml</code></pre>
              <pre><code class="hljs text">kubectl get serviceinstances</code></pre>
            </div>
          </div>
        </div>
        <aside class="notes">
          Extra commands using svcat cli:
            svcat get instances
            svcat describe instance catalogue-db-dev
        </aside>
      </section> -->

      <!-- <section id="bindingATPtoService" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
          <h2>Binding service to ATP</h2>
          <div class="fragment-set">
              <div class="fragment fade-in">
                <div class="mu-sequence">
                  <p>Binding to provisioned ATP</p>
                  <p class="mu-small">Create the file <a href="/public/catalogue-oadb-binding-dev.yaml"><b><code>catalogue-oadb-binding-dev.yaml</code></b></a>
                    with the following content:</p>
                  <pre class="mu-xsmall"><code class="hljs yaml">apiVersion: servicecatalog.k8s.io/v1beta1
kind: ServiceBinding
metadata:
  name: catalogue-oadb-wallet-binding-dev
spec:
  instanceRef:
    name: catalogue-db-dev
  parameters:
    walletPassword: "Welcome_123"</code></pre>
                  <pre><code class="hljs text">kubectl create -f catalogue-oadb-binding-dev.yaml</code></pre>
                  <pre><code class="hljs text">kubectl get servicebindings</code></pre>
              </div>
            </div>
          </div>
          <aside class="notes">
            Extra commands using svcat cli:
              svcat get bindings
              kubectl get secrets catalogue-oadb-wallet-binding-dev -o yaml
          </aside>
      </section> -->

      <!-- <section id="deployCatalogueService" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>Deploying Catalogue Service</h2>
        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p>Deploy Catalogue Service on port 80</p>
              <p class="mu-small">Create the file <b><code>catalogue-svc-dev.yaml</code></b> with the following content:</p>
              <pre class="mu-xsmall"><code class="hljs yaml">apiVersion: v1
kind: Service
metadata:
  name: catalogue-dev
  labels:
    name: catalogue-dev
spec:
  ports:
  - port: 80
    targetPort: 80
  selector:
    name: catalogue-dev</code></pre>
              <pre><code class="hljs text">kubectl create -f catalogue-svc-dev.yaml</code></pre>
              <pre><code class="hljs text">kubectl get services -l name=catalogue-dev</code></pre>
            </div>
          </div>
        </div>
      </section> -->

      <!-- <section id="configMapCatalogueSQL" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>Loading SQL Script</h2>
        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p>Creating configMap with catalogue.sql contents.</p>
              <p class="mu-small">Create the file <b><code>catalogue.sql</code></b> with the following content:</p>
              <pre class="mu-xsmall" style="height: 300px; overflow: scroll;">
                  <code class="hljs sql">SET SERVEROUTPUT ON;
SET VERIFY OFF;
BEGIN
  -- Schema User Creation
  DECLARE
    schemaUserExists INTEGER;
  BEGIN
    SELECT COUNT(*) 
    INTO schemaUserExists 
    FROM ALL_USERS 
    WHERE username = '&1';
    DBMS_OUTPUT.PUT_LINE ('** Schema creationg steps - &_DATE');
    IF schemaUserExists = 0 THEN
      DBMS_OUTPUT.PUT_LINE ('Creating schema = &1 ...');
      EXECUTE IMMEDIATE 'CREATE USER &1 IDENTIFIED BY &2';
      EXECUTE IMMEDIATE 'GRANT CREATE SESSION TO &1';
      EXECUTE IMMEDIATE 'GRANT UNLIMITED TABLESPACE TO &1';
    ELSE
      DBMS_OUTPUT.PUT_LINE ('Schema User = &1 exists, steps ignored');
    END IF;
  END;

  -- products Table Creation
  DECLARE
    tableExists INTEGER;
    tableName VARCHAR2 (20) := 'PRODUCTS';
  BEGIN
    SELECT COUNT(*) 
    INTO tableExists 
    FROM DBA_TABLES 
    WHERE owner = '&1'
    AND table_name = tableName;
    DBMS_OUTPUT.PUT_LINE ('** Table creationg steps - &_DATE');
    IF tableExists = 0 THEN
      DBMS_OUTPUT.PUT_LINE ('Creating Table ' || tableName || '...' );
      EXECUTE IMMEDIATE 'CREATE TABLE &1..' || tableName || ' (
        sku VARCHAR2(20) NOT NULL,
        brand VARCHAR2(20),
        title VARCHAR2(40),
        description VARCHAR2(500),
        weight VARCHAR2(10),
        product_size VARCHAR2(25),
        colors VARCHAR2(20),
        qty NUMBER(10, 0),
        price FLOAT, 
        image_url_1 VARCHAR2(50),
        image_url_2 VARCHAR2(50),
        PRIMARY KEY(sku)
      )';
    ELSE
      DBMS_OUTPUT.PUT_LINE ('Table '|| tableName ||' exists, steps ignored');
    END IF;
  END;

  -- categories Table Creation
  DECLARE
    tableExists INTEGER;
    tableName VARCHAR2 (20) := 'CATEGORIES';
  BEGIN
    SELECT COUNT(*) 
    INTO tableExists 
    FROM DBA_TABLES 
    WHERE owner = '&1'
    AND table_name = tableName;
    DBMS_OUTPUT.PUT_LINE ('** Table creationg steps - &_DATE');
    IF tableExists = 0 THEN
      DBMS_OUTPUT.PUT_LINE ('Creating Table ' || tableName || '...' );
      EXECUTE IMMEDIATE 'CREATE TABLE &1..' || tableName || ' (
        category_id NUMBER(7,0) GENERATED BY DEFAULT ON NULL AS IDENTITY, 
        name VARCHAR2(30), 
        PRIMARY KEY(category_id)
      )';
    ELSE
      DBMS_OUTPUT.PUT_LINE ('Table '|| tableName ||' exists, steps ignored');
    END IF;
  END;

  -- product_category Table Creation
  DECLARE
    tableExists INTEGER;
    tableName VARCHAR2 (20) := 'PRODUCT_CATEGORY';
  BEGIN
    SELECT COUNT(*) 
    INTO tableExists 
    FROM DBA_TABLES 
    WHERE owner = '&1'
    AND table_name = tableName;
    DBMS_OUTPUT.PUT_LINE ('** Table creationg steps - &_DATE');
    IF tableExists = 0 THEN
      DBMS_OUTPUT.PUT_LINE ('Creating Table ' || tableName || '...' );
      EXECUTE IMMEDIATE 'CREATE TABLE &1..' || tableName || ' (
        product_category_id NUMBER(7,0) GENERATED BY DEFAULT ON NULL AS IDENTITY,
        sku VARCHAR2(40), 
        category_id NUMBER(7,0) NOT NULL, 
        FOREIGN KEY (sku) 
          REFERENCES &1..PRODUCTS(sku), 
        FOREIGN KEY(category_id)
          REFERENCES &1..CATEGORIES(category_id),
        PRIMARY KEY(product_category_id)
      )';
    ELSE
      DBMS_OUTPUT.PUT_LINE ('Table '|| tableName ||' exists, steps ignored');
    END IF;
  END;

  -- Role Creation
  DECLARE
    roleExists INTEGER;
    roleName VARCHAR2 (100);
  BEGIN
    roleName := '&1' || '_ROLE';
    SELECT COUNT(*) 
    INTO roleExists 
    FROM DBA_ROLES 
    WHERE role = roleName;
    DBMS_OUTPUT.PUT_LINE ('** Role creationg steps - &_DATE');
    IF roleExists = 0 THEN
      DBMS_OUTPUT.PUT_LINE ('Creating Role ' || roleName || '...' );
      EXECUTE IMMEDIATE 'CREATE ROLE ' || roleName;
      EXECUTE IMMEDIATE 'GRANT ' || roleName || ' TO &1';
      EXECUTE IMMEDIATE 'GRANT SELECT ON &1..PRODUCTS TO ' || roleName;
      EXECUTE IMMEDIATE 'GRANT SELECT ON &1..CATEGORIES TO ' || roleName;
      EXECUTE IMMEDIATE 'GRANT SELECT ON &1..PRODUCT_CATEGORY TO ' || roleName;
    ELSE
      DBMS_OUTPUT.PUT_LINE ('Role '|| roleName ||' exists, steps ignored');
    END IF;
  END;
END;
/

-- Populate Data
BEGIN
  DBMS_OUTPUT.PUT_LINE ('** Populating Data... - &_DATE');
  BEGIN
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-001', 'Original', 'Original Unscented Litter Trapper', 'Provide effective cat litter odor control in your cat''s litter box area with Original Texture cat litter. This formula absorbs three times the moisture by volume when compared to clay-based litter, keeping her litter box fresh and welcoming.','151lbs','0','0', 99, 18.50, 'MU-US-001.png', 'MU-US-001_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-002', 'Tidy Cats', 'Instant Action Mu BroomKit', 'Put an end to overpowering odors in your home with Purina Tidy Cats Instant Action clumping litter for multiple cats. We know you have no time to waste, and that is no problem with this unique formula. This clumping cat litter is designed to trap odors from the start.','20lbs','0','0', 99, 28.99 , 'MU-US-002.png', 'MU-US-002_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-003', 'Choco Spring', 'Mu DeoSpray Deodorizer', 'With Choco Spring scents lingering in the air, your cat''s time in the bathroom doesn''t have to be so smelly anymore! This deodorizer perfumes the air and helps make the litter last longer so you and your cat can enjoy a breath of sweetly-scented air.','26Oz','0','0', 99, 7.99, 'MU-US-003.png', 'MU-US-003_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-004', 'Arm ' || chr(38) || ' Hammer', 'Mu O-DeoSpray Deodorizer', 'Add an extra boost of freshness to your litter box. ARM ' || chr(38) || ' HAMMER‚Ñ¢ baking soda destroys odors instantly in all types of litter ‚Äì so your box stays first-day fresh longer. ','20Oz','0','0', 99, 4.99, 'MU-US-004.png', 'MU-US-004_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-005', 'Petmate', 'Cat Litter Mu LitterBox', 'Stay Fresh litter pans are created with Microban antimicrobial product, which inhibits the growth of stain- and odor-causing bacteria. Made in the USA.','0','18.7" x 15.5" x 10.6"','0', 99, 9.50, 'MU-US-005.png', 'MU-US-005_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-006', 'Tidy Cats', 'Mu X-DeoSpray Deodorizer', 'Change the way you think about cleaning your cat''s litter box with the Purina Tidy Cats BREEZE With Ammonia Blocker Litter System starter kit. This system features powerful odor control to keep your house smelling fresh and clean, and the specially designed, cat-friendly litter pellets minimize your pets from tracking litter throughout your home.','0','18.7" x 15.5" x 10.6"','0', 99, 39.25, 'MU-US-006.png', 'MU-US-006_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-007', 'Petsafe', 'Original MuMate Bowl', 'Original Pet Fountain with Bonus Reservoir provides 50 oz of fresh, filtered water to your pet, with an additional Bonus 50 Ounce Reservoir. A patented free-falling stream of water entices your pet to drink more and continually aerates the water with healthful oxygen.','0','0','0', 99, 43.95, 'MU-US-007.png', 'MU-US-007_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-008', 'Petsafe', 'Drinkwell BrandX Feeder', 'The Pagoda fountain continuously recirculates 70 ounces of fresh, filtered water. Best of all, the stylish ceramic design is easy to clean and looks great in your home. The upper and lower dishes provide two drinking areas for pets, and the patented dual free-falling streams aerate the water for freshness, which encourages your pet to drink more.','0','0','red, white', 99, 79.95, 'MU-US-008.png', 'MU-US-008_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-009', 'Petmate', 'Crock Small Coastal FishBowl', 'Standard crock small animal dish is uses a heavy weight design that eliminates movement and spillage.','0','3"','0', 99, 4.75, 'MU-US-009.png', 'MU-US-009_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-010', 'Loving Pet', 'Mu Fusion Bowl', 'Functional and beautiful, Bella Bowls are truly the perfect pet dish. Loving Pets brings new life to veterinarian-recommended stainless steel dog bowls and pet feeding dishes by combining a stainless interior with an attractive poly-resin exterior. A removable rubber base prevents spills, eliminates noise, and makes Bella Bowls fully dishwasher safe.','0','S,M,L,XL','0', 99, 5.99, 'MU-US-010.png', 'MU-US-010_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-011', 'Petsafe', 'Mu Mat Green Placemat', 'Petrageous Designs pet placemats are the perfect way to keep your pets'' feeding area clean and classy! This ultra-durable Food/Water Placemat keeps nasty spills and stray kibble off your clean floors, while adding playful character to your home''s decor. Easy to clean.','0','0','0', 99, 4.99, 'MU-US-011.png', 'MU-US-011_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-012', 'Loving Pet', 'Mu Mat Blue Placemat', 'Clean, clean, clean! Your little feline can be a messy eater too, and when they''re done you have to clean their dining area. Keep the feeding area around your pet mess free with the Meow Meow Bowl Mat. This fun mat with fish bones and cat sayings is a design you and your pet are sure to love.','0','0','0', 99, 11.95, 'MU-US-012.png', 'MU-US-012_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-013', 'Petsafe', 'Mu Storage Container', 'Pet Food Storage Container features a tight seal to ensure your pet''s food will stay fresh longer, reducing spoilage due to pests and moisture. Made from FDS food contact approved plastic.','15lbs','0','0', 99, 9.99, 'MU-US-013.png', 'MU-US-013_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-014', 'Pet Food', 'Chicken ' || chr(38) || ' Pomegranate Mu Cat Food', 'Your cats deserve the best scientifically proven food to maintain a healthy weight. Natural and Delicious Grain Free Chicken ' || chr(38) || ' Pomegranate Recipe Dry Cat Food does not contain any cereal or grains of any kind and is completely replaced with the highest quality protein. ','10lbs','0','0', 99, 38.95, 'MU-US-014.png', 'MU-US-014_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-015', 'Pet Food', 'Cat and Kitten BlueHill MagiK', 'Cat and Kitten recipe is a grain-free, region-inspired formula that your cat will thrive on. An excellent choice for cats of all breed and ages, this biologically appropriate recipe contains an unmatched variety of fresh regional ingredients delivered daily from local Kentucky farms. Packed with over 75% meat, the recipe features free-fun Cobb chicken, nest-laid eggs, Tom turkey, Blue catfish and Rainbow trout in wholeprey ratios in order to mimic the diet mother nature intended.','12lbs','0','0', 99, 49.95, 'MU-US-015.png', 'MU-US-015_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-016', 'Weruva', 'Go Cat Variety Pouches Pack', 'Let''s show our cats that they are truly our best friends, with the new Weruva Grain-Free BFF OMG Pouches Variety Pack. Made with white breast chicken, real, sustainably caught tuna, fresh wild caught salmon, and other real, deboned meats, Weruva has created the perfect meal for our furry, purring best friends. ','3Oz','0','0', 99, 12.99, 'MU-US-016.png', 'MU-US-016_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-017', 'Weruva', 'Love Me Variety Pack Green', 'Full of duck, tuna, and white breast, skinless, and boneless chicken, this wholesome food is full of protein and free of any grains, GMOs, MSG, and carrageenan for a balanced meal in each can. Weruva Cats In the Kitchen Love Me Tender Pouches Wet Cat Food will fill your cat with love, tenderly with every meal.','3Oz','0','0', 99, 15.99, 'MU-US-017.png', 'MU-US-017_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-018', 'Royal Canin', 'SO Dry Cat Food', 'Whether this is your cat‚Äôs first urinary issue or they need ongoing urinary care, your vet recommended Royal Canin Urinary SO for a reason. This veterinary-exclusive dry cat food was developed to nutritionally support your adult cat‚Äôs urinary tract and bladder health. It increases the amount of urine your cat produces to help dilute excess minerals that can cause crystals and stones.','15lbs','0','0', 99, 68.74, 'MU-US-018.png', 'MU-US-018_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-019', 'Royal Canin', 'Care with Chicken BlueHill MagiK', 'A healthy bladder starts with the right balance of vital nutrients. Excess minerals can encourage the formation of crystals in the urine, which may lead to the creation of bladder stones. They can cause discomfort and lead to more serious problems that require the care of a veterinarian. ','15lbs','0','0', 99, 72.75, 'MU-US-019.png', 'MU-US-019_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-020', 'Wellness', 'Wet Canned Mu Dry Food', 'Wellness Complete Health Natural Grain Free Chicken Recipe Canned Cat Food is made with 100% Human Grade Ingredients and uses delicious fruits and vegetables which contain vitamins and antioxidants to help maintain your cats healthy immune system. ','12Oz','0','0', 99, 49.75, 'MU-US-020.png', 'MU-US-020_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-021', 'Wellness', 'Green Pea Formula Mu Cat Food', 'Designed with a limited number of premium protein and carbohydrate sources, this Grain-free cat food is an excellent choice when seeking alternative ingredients for your cat. Natural Balance L.I.D. Limited Ingredient Diets Duck and Green Pea Formula Canned Cat Food is designed to support healthy digestion and to maintain skin and coat health‚Äîall while providing complete, balanced nutrition for all life stages!','12Oz','0','0', 99, 39.99, 'MU-US-021.png', 'MU-US-021_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-022', 'Amazing Paw', 'Wire Cat KittyBrush', 'For a well groomed appearance, cats and kittens need to be brushed regularly. The Magic Coat¬Æ Slicker Wire Brushes are designed to easily remove mats while pulling out dead hair. Brushing helps stimulate the skin to promote healthy circulation and increase shine.','0','0','0', 99, 6.99, 'MU-US-022.png', 'MU-US-022_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-023', 'Amazing Paw', 'Groom Genie KittyBrush', 'The Groom Genie evolved from a brush designed for humans ‚Äì the Knot Genie. Rikki Mor, a mom of three, was frustrated with the huge cost and lack of effectiveness of other detangling brushes on the market. So she took matters into her own hands and invented what is now known as The World''s Best Detangling Brush.','0','0','0', 99, 4.75, 'MU-US-023.png', 'MU-US-023_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-024', 'Amazing Paw', 'Oatmeal and Aloe 2-in-1 Shampoo', 'Earthbath specially formulated this Oatmeal ' || chr(38) || ' Aloe itch relief shampoo to address the needs of beloved pets with dry, itchy skin. Oatmeal and aloe vera are recommended by veterinarians to effectively combat skin irritation, promote healing, and re-moisturize sensitive, dry skin.','15Oz','0','0', 99, 12.49, 'MU-US-024.png', 'MU-US-024_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-025', 'Amazing Paw', 'Oatmeal and Aloe Protein Shampoo', 'The addition of 3% colloidal oatmeal and aloe vera helps re-moisturize and soothe skin, too. Our sumptuous Shampoo will leave your best friend‚Äôs coat soft and plush while bringing out its natural luster and brilliance.','15Oz','0','0', 99, 13.49, 'MU-US-025.png', 'MU-US-025_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-026', 'Amazing Paw', 'Grooming Mitt for Cats', 'Cleans and softens cat‚Äôs coat, removes loose hair and gently massages. Made with lightweight neoprene material with adjustable closer and soft rubber nubs, the Love Glove¬Æ mitt is also great for removing loose cat hair from furniture and clothing.','0','0','0', 99, 6.99, 'MU-US-026.png', 'MU-US-026_1.png');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCTS(SKU)) */ INTO &1..PRODUCTS VALUES ('MU-US-027', 'Amazing Paw', 'Motion Lithium Ion Clipper', 'Powerful motor up to 5,500 SPM''s with integrated rapid power. The ''5 in 1'' Pro Blade for less breakage and optimal usage. Blade and clipper are ALWAYS cool running. Lithium Ion battery technology gives optimal performance. 90 minutes of cordless runtime with 45 minute quick full charge. Higher performance, longer usage times and consistent reliability. ','0','0','0', 99, 199.99, 'MU-US-027.png', 'MU-US-027_1.png');

    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('1','Cleaning Supplies');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('2','Deodorizers');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('3','Litter Accessories');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('4','Litter Boxes');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('5','Auto Feeders');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('6','Bowls');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('7','Placemats');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('8','Storage');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('9','Dry Food');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('10','Food Pouches');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('11','Limited Diet');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('12','Wet Food');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('13','Brushes');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('14','Grooming Tools');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(CATEGORIES(CATEGORY_ID)) */ INTO &1..CATEGORIES VALUES ('15','Shampoos and Conditioners');

    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('1','MU-US-001', '3');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('2','MU-US-002', '3');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('3','MU-US-003', '2');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('4','MU-US-004', '2');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('5','MU-US-005', '4');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('6','MU-US-006', '4');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('7','MU-US-007', '5');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('8','MU-US-008', '5');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('9','MU-US-009', '6');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('10','MU-US-010', '6');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('11','MU-US-011', '7');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('12','MU-US-012', '7');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('13','MU-US-013', '8');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('14','MU-US-014', '9');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('15','MU-US-015', '9');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('16','MU-US-016', '10');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('17','MU-US-017', '10');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('18','MU-US-018', '11');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('19','MU-US-019', '11');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('20','MU-US-020', '12');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('21','MU-US-021', '12');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('22','MU-US-022', '13');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('23','MU-US-023', '13');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('24','MU-US-024', '15');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('25','MU-US-025', '15');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('26','MU-US-026', '14');
    INSERT /*+ IGNORE_ROW_ON_DUPKEY_INDEX(PRODUCT_CATEGORY(PRODUCT_CATEGORY_ID)) */ INTO &1..PRODUCT_CATEGORY VALUES ('27','MU-US-027', '14');

    COMMIT;
  END;
END;
/

quit;
/
                      
                  </code></pre>
              <pre><code class="hljs text">kubectl create configmap catalogue-sql --from-file=catalogue.sql</code></pre>
            </div>
          </div>
        </div>
      </section>       -->

      <!-- <section id="deployCatalogueDeployment" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>Catalogue Deployment</h2>
        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p class="mu-small">Create the file <b><code>catalogue-dep-dev.yaml</code></b> with the following content:</p>
              <pre class="mu-xsmall" style="height: 300px; overflow: scroll;">
                <code class="hljs yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: catalogue-dev
  labels:
    name: catalogue-dev
spec:
  replicas: 1
  selector:
    matchLabels:
      name: catalogue-dev
  template:
    metadata:
      labels:
        name: catalogue-dev
    spec:
      terminationGracePeriodSeconds: 5
      initContainers:
      - name: decode-wallet
        image: oraclelinux:7-slim
        command: ["/bin/sh","-c"]
        args: 
        - for i in `ls -1 /tmp/wallet | grep -v user_name`; do cat /tmp/wallet/$i  | base64 --decode > /wallet/$i; done; ls -l /wallet/*;
        volumeMounts:
        - name: wallet-raw
          mountPath: /tmp/wallet
          readOnly: false
        - name: wallet
          mountPath: /wallet
      - name: init-service-database
        image: phx.ocir.io/intvravipati/mushop/dbtools:1.0.1
        command: ["/bin/sh","-c"]
        args: 
        - sqlplus ADMIN/\"s123456789S@\"@cataloguedev_tp @service.sql CATALOGUE_USER default_Password1
        volumeMounts:
          - name: wallet
            mountPath: /usr/lib/oracle/19.3/client64/lib/network/admin/
            readOnly: true
          - name: service-sql
            mountPath: /work/
      containers:
        - name: catalogue
          image: phx.ocir.io/intvravipati/mushop/catalogue:1.2
          imagePullPolicy: Always
          command: ["/app"]
          args:
          - -port=80
          ports:
          - containerPort: 80
          env:
          - name: ZIPKIN
            value: ""
          - name: OADB_USER
            value: CATALOGUE_USER
          - name: OADB_PW
            value: default_Password1
          - name: OADB_SERVICE
            value: cataloguedev_tp
          securityContext:
            capabilities:
              drop:
                - all
              add:
                - NET_BIND_SERVICE
            readOnlyRootFilesystem: true
          livenessProbe:
            httpGet:
              path: /health
              port: 80
            initialDelaySeconds: 300
            periodSeconds: 3
          readinessProbe:
            httpGet:
              path: /health
              port: 80
            initialDelaySeconds: 180
            periodSeconds: 3          
          resources:
            requests:
              cpu: 100m
              memory: 64Mi
            limits:
              cpu: 200m
              memory: 128Mi
          volumeMounts:
          - name: wallet
            mountPath: /usr/lib/oracle/19.3/client64/lib/network/admin/
            readOnly: true
      volumes:
      - name: wallet-raw
        secret:
          secretName: catalogue-oadb-wallet-binding-dev
      - name: wallet
        emptyDir: {}
      - name: service-sql
        configMap:
          name: catalogue-sql
          items:
          - key: catalogue.sql
            path: service.sql</code></pre>
              <pre><code class="hljs text">kubectl create -f catalogue-dep-dev.yaml</code></pre>
              <pre><code class="hljs text">kubectl get deployments -l name=catalogue-dev</code></pre>
            </div>
          </div>
        </div>
      </section>       -->

      <!-- <section id="testCatalogueService" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
        <h2>Test Deployed Catalogue</h2>
        <div class="fragment-set">
          <div class="fragment fade-in">
            <div class="mu-sequence">
              <p class="mu-small">In one terminal, do port forward to your localhost:8000 :</p>
              <pre><code class="hljs text">kubectl port-forward svc/catalogue-dev 8000:80</code></pre>
              <p class="mu-small">In another terminal, test response from the service connected to ATP:</p>
              <pre><code class="hljs text">curl localhost:8000/catalogue</code></pre>
            </div>
          </div>
        </div>
      </section>  -->

      <!-- <section id="goATPmicroservice" data-background-image="/images/tech/k8s.png" data-background-size="100px" data-background-position="20px 20px">
          <h2>Reviewing sample Go-ATP service</h2>
          <div class="fragment-set">
            <div class="fragment fade-in">
              <div class="mu-sequence">
                <p>GoLang App using database/sql and goracle.v2</p>
              </div>
            </div>
          </div>
      </section> -->

      <section id="resources">
        <h2>Resources</h2>
        <ul>
          <li><a href="https://svc-cat.io/">Kubernetes Service Catalog</a></li>
          <li><a href="https://www.openservicebrokerapi.org/">Open Service Broker API</a></li>
          <li><a href="https://github.com/oracle/oci-service-broker">Github: OCI Service Broker</a></li>
          <li><a href="https://docs.cloud.oracle.com/iaas/Content/ContEng/Tasks/contengaddingservicebrokers.htm">Adding OCI Service Broker for Kubernetes to Clusters</a></li>
        </ul>
      </section>